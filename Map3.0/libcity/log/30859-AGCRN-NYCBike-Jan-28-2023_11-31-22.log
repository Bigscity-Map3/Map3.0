2023-01-28 11:31:22,621 - INFO - Log directory: ./libcity/log
2023-01-28 11:31:22,622 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCBike, exp_id=30859
2023-01-28 11:31:22,622 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCBike', 'saved_model': True, 'train': True, 'seed': 0, 'dataset_class': 'TrafficStateGridDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'max_epoch': 100, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'patience': 50, 'batch_size': 32, 'cache_dataset': True, 'num_workers': 1, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 19, 'output_window': 1, 'use_row_column': True, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'metrics': ['MAE', 'MAPE', 'MSE', 'RMSE', 'masked_MAE', 'masked_MAPE', 'masked_MSE', 'masked_RMSE', 'R2', 'EVAR'], 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Polygon'], 'Polygon': {'row_id': 'num', 'column_id': 'num'}}, 'grid': {'including_types': ['state'], 'state': {'row_id': 16, 'column_id': 8, 'new_flow': 'num', 'end_flow': 'num'}}, 'data_col': ['new_flow', 'end_flow'], 'data_files': ['NYCBIKE20140409'], 'geo_file': 'NYCBIKE20140409', 'output_dim': 2, 'time_intervals': 3600, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': False, 'weight_adj_epsilon': 0.1, 'device': device(type='cuda', index=0), 'exp_id': 30859}
2023-01-28 11:31:22,630 - INFO - Loaded file NYCBIKE20140409.geo, num_grids=128, grid_size=(16, 8)
2023-01-28 11:31:22,630 - INFO - Generate grid rel file, shape=(128, 128)
2023-01-28 11:31:22,631 - INFO - Loading ./libcity/cache/dataset_cache/grid_based_NYCBike_19_1_0.7_0.1_standard_32_False_False_False_True_True.npz
2023-01-28 11:31:23,063 - INFO - train	x: (3061, 19, 16, 8, 2), y: (3061, 1, 16, 8, 2)
2023-01-28 11:31:23,063 - INFO - eval	x: (437, 19, 16, 8, 2), y: (437, 1, 16, 8, 2)
2023-01-28 11:31:23,063 - INFO - test	x: (875, 19, 16, 8, 2), y: (875, 1, 16, 8, 2)
2023-01-28 11:31:23,164 - INFO - StandardScaler mean: 9.23899494542977, std: 18.095629608758927
2023-01-28 11:31:23,164 - INFO - NoneScaler
2023-01-28 11:31:28,650 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 2, kernel_size=(1, 64), stride=(1, 1))
)
2023-01-28 11:31:28,651 - INFO - node_embeddings	torch.Size([128, 10])	cuda:0	True
2023-01-28 11:31:28,651 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2023-01-28 11:31:28,651 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2023-01-28 11:31:28,651 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2023-01-28 11:31:28,651 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - end_conv.weight	torch.Size([2, 1, 1, 64])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - end_conv.bias	torch.Size([2])	cuda:0	True
2023-01-28 11:31:28,652 - INFO - Total parameter numbers: 750210
2023-01-28 11:31:28,652 - INFO - You select `adam` optimizer.
2023-01-28 11:31:28,652 - WARNING - Received none train loss func and will use the loss func defined in the model.
2023-01-28 11:31:28,652 - INFO - Start training ...
2023-01-28 11:31:28,652 - INFO - num_batches:96
2023-01-28 11:31:46,552 - INFO - epoch complete!
2023-01-28 11:31:46,554 - INFO - 17.89790105819702
2023-01-28 11:31:46,554 - INFO - evaluating now!
2023-01-28 11:31:47,812 - INFO - Epoch [0/100] train_loss: 10.3182, val_loss: 7.8173, lr: 0.003000, 19.16s
2023-01-28 11:31:47,830 - INFO - Saved model at 0
2023-01-28 11:31:47,831 - INFO - Val loss decrease from inf to 7.8173, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch0.tar
2023-01-28 11:32:06,324 - INFO - epoch complete!
2023-01-28 11:32:06,325 - INFO - 18.49251914024353
2023-01-28 11:32:06,325 - INFO - evaluating now!
2023-01-28 11:32:07,604 - INFO - Epoch [1/100] train_loss: 7.2791, val_loss: 7.0690, lr: 0.003000, 19.77s
2023-01-28 11:32:07,626 - INFO - Saved model at 1
2023-01-28 11:32:07,626 - INFO - Val loss decrease from 7.8173 to 7.0690, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch1.tar
2023-01-28 11:32:26,094 - INFO - epoch complete!
2023-01-28 11:32:26,095 - INFO - 18.46640396118164
2023-01-28 11:32:26,096 - INFO - evaluating now!
2023-01-28 11:32:27,382 - INFO - Epoch [2/100] train_loss: 6.6079, val_loss: 6.4682, lr: 0.003000, 19.75s
2023-01-28 11:32:27,401 - INFO - Saved model at 2
2023-01-28 11:32:27,401 - INFO - Val loss decrease from 7.0690 to 6.4682, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch2.tar
2023-01-28 11:32:45,483 - INFO - epoch complete!
2023-01-28 11:32:45,485 - INFO - 18.081154108047485
2023-01-28 11:32:45,485 - INFO - evaluating now!
2023-01-28 11:32:46,768 - INFO - Epoch [3/100] train_loss: 6.1738, val_loss: 5.9863, lr: 0.003000, 19.37s
2023-01-28 11:32:46,786 - INFO - Saved model at 3
2023-01-28 11:32:46,786 - INFO - Val loss decrease from 6.4682 to 5.9863, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch3.tar
2023-01-28 11:33:04,827 - INFO - epoch complete!
2023-01-28 11:33:04,828 - INFO - 18.040647268295288
2023-01-28 11:33:04,828 - INFO - evaluating now!
2023-01-28 11:33:06,075 - INFO - Epoch [4/100] train_loss: 5.8349, val_loss: 5.7585, lr: 0.003000, 19.29s
2023-01-28 11:33:06,091 - INFO - Saved model at 4
2023-01-28 11:33:06,091 - INFO - Val loss decrease from 5.9863 to 5.7585, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch4.tar
2023-01-28 11:33:24,429 - INFO - epoch complete!
2023-01-28 11:33:24,429 - INFO - 18.337334156036377
2023-01-28 11:33:24,430 - INFO - evaluating now!
2023-01-28 11:33:25,662 - INFO - Epoch [5/100] train_loss: 5.6902, val_loss: 5.6208, lr: 0.003000, 19.57s
2023-01-28 11:33:25,679 - INFO - Saved model at 5
2023-01-28 11:33:25,679 - INFO - Val loss decrease from 5.7585 to 5.6208, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch5.tar
2023-01-28 11:33:44,034 - INFO - epoch complete!
2023-01-28 11:33:44,036 - INFO - 18.354580402374268
2023-01-28 11:33:44,036 - INFO - evaluating now!
2023-01-28 11:33:45,345 - INFO - Epoch [6/100] train_loss: 5.5110, val_loss: 5.4851, lr: 0.003000, 19.67s
2023-01-28 11:33:45,362 - INFO - Saved model at 6
2023-01-28 11:33:45,362 - INFO - Val loss decrease from 5.6208 to 5.4851, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch6.tar
2023-01-28 11:34:03,723 - INFO - epoch complete!
2023-01-28 11:34:03,724 - INFO - 18.35996699333191
2023-01-28 11:34:03,725 - INFO - evaluating now!
2023-01-28 11:34:04,993 - INFO - Epoch [7/100] train_loss: 5.3815, val_loss: 5.6568, lr: 0.003000, 19.63s
2023-01-28 11:34:23,009 - INFO - epoch complete!
2023-01-28 11:34:23,009 - INFO - 18.01399850845337
2023-01-28 11:34:23,009 - INFO - evaluating now!
2023-01-28 11:34:24,273 - INFO - Epoch [8/100] train_loss: 5.3524, val_loss: 5.4692, lr: 0.003000, 19.28s
2023-01-28 11:34:24,293 - INFO - Saved model at 8
2023-01-28 11:34:24,293 - INFO - Val loss decrease from 5.4851 to 5.4692, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch8.tar
2023-01-28 11:34:42,524 - INFO - epoch complete!
2023-01-28 11:34:42,525 - INFO - 18.22966718673706
2023-01-28 11:34:42,525 - INFO - evaluating now!
2023-01-28 11:34:43,811 - INFO - Epoch [9/100] train_loss: 5.2722, val_loss: 5.4285, lr: 0.003000, 19.52s
2023-01-28 11:34:43,829 - INFO - Saved model at 9
2023-01-28 11:34:43,829 - INFO - Val loss decrease from 5.4692 to 5.4285, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch9.tar
2023-01-28 11:35:02,148 - INFO - epoch complete!
2023-01-28 11:35:02,149 - INFO - 18.318848848342896
2023-01-28 11:35:02,149 - INFO - evaluating now!
2023-01-28 11:35:03,440 - INFO - Epoch [10/100] train_loss: 5.2152, val_loss: 5.4112, lr: 0.003000, 19.61s
2023-01-28 11:35:03,460 - INFO - Saved model at 10
2023-01-28 11:35:03,460 - INFO - Val loss decrease from 5.4285 to 5.4112, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch10.tar
2023-01-28 11:35:21,597 - INFO - epoch complete!
2023-01-28 11:35:21,598 - INFO - 18.136767864227295
2023-01-28 11:35:21,599 - INFO - evaluating now!
2023-01-28 11:35:22,866 - INFO - Epoch [11/100] train_loss: 5.1951, val_loss: 5.3056, lr: 0.003000, 19.41s
2023-01-28 11:35:22,883 - INFO - Saved model at 11
2023-01-28 11:35:22,883 - INFO - Val loss decrease from 5.4112 to 5.3056, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch11.tar
2023-01-28 11:35:41,294 - INFO - epoch complete!
2023-01-28 11:35:41,295 - INFO - 18.41051173210144
2023-01-28 11:35:41,295 - INFO - evaluating now!
2023-01-28 11:35:42,555 - INFO - Epoch [12/100] train_loss: 5.1366, val_loss: 5.3415, lr: 0.003000, 19.67s
2023-01-28 11:36:00,821 - INFO - epoch complete!
2023-01-28 11:36:00,822 - INFO - 18.26432704925537
2023-01-28 11:36:00,822 - INFO - evaluating now!
2023-01-28 11:36:02,093 - INFO - Epoch [13/100] train_loss: 5.1028, val_loss: 5.2846, lr: 0.003000, 19.54s
2023-01-28 11:36:02,110 - INFO - Saved model at 13
2023-01-28 11:36:02,110 - INFO - Val loss decrease from 5.3056 to 5.2846, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch13.tar
2023-01-28 11:36:20,184 - INFO - epoch complete!
2023-01-28 11:36:20,185 - INFO - 18.072938919067383
2023-01-28 11:36:20,185 - INFO - evaluating now!
2023-01-28 11:36:21,449 - INFO - Epoch [14/100] train_loss: 5.1036, val_loss: 5.3958, lr: 0.003000, 19.34s
2023-01-28 11:36:40,000 - INFO - epoch complete!
2023-01-28 11:36:40,001 - INFO - 18.550223112106323
2023-01-28 11:36:40,001 - INFO - evaluating now!
2023-01-28 11:36:41,277 - INFO - Epoch [15/100] train_loss: 5.0231, val_loss: 5.2953, lr: 0.003000, 19.83s
2023-01-28 11:36:59,606 - INFO - epoch complete!
2023-01-28 11:36:59,607 - INFO - 18.32717490196228
2023-01-28 11:36:59,607 - INFO - evaluating now!
2023-01-28 11:37:00,851 - INFO - Epoch [16/100] train_loss: 4.9881, val_loss: 5.2718, lr: 0.003000, 19.57s
2023-01-28 11:37:00,870 - INFO - Saved model at 16
2023-01-28 11:37:00,871 - INFO - Val loss decrease from 5.2846 to 5.2718, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch16.tar
2023-01-28 11:37:18,851 - INFO - epoch complete!
2023-01-28 11:37:18,852 - INFO - 17.979540586471558
2023-01-28 11:37:18,853 - INFO - evaluating now!
2023-01-28 11:37:20,108 - INFO - Epoch [17/100] train_loss: 4.9958, val_loss: 5.2729, lr: 0.003000, 19.24s
2023-01-28 11:37:38,589 - INFO - epoch complete!
2023-01-28 11:37:38,590 - INFO - 18.480472803115845
2023-01-28 11:37:38,590 - INFO - evaluating now!
2023-01-28 11:37:39,885 - INFO - Epoch [18/100] train_loss: 4.9844, val_loss: 5.2371, lr: 0.003000, 19.78s
2023-01-28 11:37:39,901 - INFO - Saved model at 18
2023-01-28 11:37:39,902 - INFO - Val loss decrease from 5.2718 to 5.2371, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch18.tar
2023-01-28 11:37:58,308 - INFO - epoch complete!
2023-01-28 11:37:58,310 - INFO - 18.40634536743164
2023-01-28 11:37:58,310 - INFO - evaluating now!
2023-01-28 11:37:59,625 - INFO - Epoch [19/100] train_loss: 4.9623, val_loss: 5.2897, lr: 0.003000, 19.72s
2023-01-28 11:38:18,354 - INFO - epoch complete!
2023-01-28 11:38:18,355 - INFO - 18.72774314880371
2023-01-28 11:38:18,355 - INFO - evaluating now!
2023-01-28 11:38:19,641 - INFO - Epoch [20/100] train_loss: 4.9330, val_loss: 5.2110, lr: 0.003000, 20.02s
2023-01-28 11:38:19,657 - INFO - Saved model at 20
2023-01-28 11:38:19,657 - INFO - Val loss decrease from 5.2371 to 5.2110, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch20.tar
2023-01-28 11:38:38,158 - INFO - epoch complete!
2023-01-28 11:38:38,159 - INFO - 18.500828981399536
2023-01-28 11:38:38,159 - INFO - evaluating now!
2023-01-28 11:38:39,455 - INFO - Epoch [21/100] train_loss: 4.9185, val_loss: 5.1846, lr: 0.003000, 19.80s
2023-01-28 11:38:39,473 - INFO - Saved model at 21
2023-01-28 11:38:39,473 - INFO - Val loss decrease from 5.2110 to 5.1846, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch21.tar
2023-01-28 11:38:57,780 - INFO - epoch complete!
2023-01-28 11:38:57,781 - INFO - 18.306645393371582
2023-01-28 11:38:57,782 - INFO - evaluating now!
2023-01-28 11:38:59,108 - INFO - Epoch [22/100] train_loss: 4.8940, val_loss: 5.2529, lr: 0.003000, 19.63s
2023-01-28 11:39:17,692 - INFO - epoch complete!
2023-01-28 11:39:17,693 - INFO - 18.582154273986816
2023-01-28 11:39:17,693 - INFO - evaluating now!
2023-01-28 11:39:18,989 - INFO - Epoch [23/100] train_loss: 4.8570, val_loss: 5.2400, lr: 0.003000, 19.88s
2023-01-28 11:39:37,350 - INFO - epoch complete!
2023-01-28 11:39:37,352 - INFO - 18.36051034927368
2023-01-28 11:39:37,352 - INFO - evaluating now!
2023-01-28 11:39:38,580 - INFO - Epoch [24/100] train_loss: 4.8704, val_loss: 5.3061, lr: 0.003000, 19.59s
2023-01-28 11:39:56,517 - INFO - epoch complete!
2023-01-28 11:39:56,518 - INFO - 17.935617923736572
2023-01-28 11:39:56,518 - INFO - evaluating now!
2023-01-28 11:39:57,734 - INFO - Epoch [25/100] train_loss: 4.8341, val_loss: 5.2793, lr: 0.003000, 19.15s
2023-01-28 11:40:15,618 - INFO - epoch complete!
2023-01-28 11:40:15,619 - INFO - 17.883310556411743
2023-01-28 11:40:15,619 - INFO - evaluating now!
2023-01-28 11:40:16,885 - INFO - Epoch [26/100] train_loss: 4.8196, val_loss: 5.1946, lr: 0.003000, 19.15s
2023-01-28 11:40:34,682 - INFO - epoch complete!
2023-01-28 11:40:34,683 - INFO - 17.795941591262817
2023-01-28 11:40:34,683 - INFO - evaluating now!
2023-01-28 11:40:35,918 - INFO - Epoch [27/100] train_loss: 4.7979, val_loss: 5.2585, lr: 0.003000, 19.03s
2023-01-28 11:40:53,742 - INFO - epoch complete!
2023-01-28 11:40:53,743 - INFO - 17.8232638835907
2023-01-28 11:40:53,743 - INFO - evaluating now!
2023-01-28 11:40:54,979 - INFO - Epoch [28/100] train_loss: 4.7843, val_loss: 5.1827, lr: 0.003000, 19.06s
2023-01-28 11:40:54,995 - INFO - Saved model at 28
2023-01-28 11:40:54,995 - INFO - Val loss decrease from 5.1846 to 5.1827, saving to ./libcity/cache/30859/model_cache/AGCRN_NYCBike_epoch28.tar
2023-01-28 11:41:12,826 - INFO - epoch complete!
2023-01-28 11:41:12,827 - INFO - 17.831085920333862
2023-01-28 11:41:12,827 - INFO - evaluating now!
2023-01-28 11:41:14,040 - INFO - Epoch [29/100] train_loss: 4.7676, val_loss: 5.2926, lr: 0.003000, 19.05s
2023-01-28 11:41:32,037 - INFO - epoch complete!
2023-01-28 11:41:32,039 - INFO - 17.994771718978882
2023-01-28 11:41:32,040 - INFO - evaluating now!
2023-01-28 11:41:33,309 - INFO - Epoch [30/100] train_loss: 4.7937, val_loss: 5.2253, lr: 0.003000, 19.27s
2023-01-28 11:41:51,374 - INFO - epoch complete!
2023-01-28 11:41:51,374 - INFO - 18.06370496749878
2023-01-28 11:41:51,375 - INFO - evaluating now!
2023-01-28 11:41:52,589 - INFO - Epoch [31/100] train_loss: 4.7432, val_loss: 5.2704, lr: 0.003000, 19.28s
2023-01-28 11:42:10,866 - INFO - epoch complete!
2023-01-28 11:42:10,867 - INFO - 18.27520442008972
2023-01-28 11:42:10,867 - INFO - evaluating now!
2023-01-28 11:42:12,079 - INFO - Epoch [32/100] train_loss: 4.7089, val_loss: 5.1953, lr: 0.003000, 19.49s
2023-01-28 11:42:29,929 - INFO - epoch complete!
2023-01-28 11:42:29,930 - INFO - 17.84942650794983
2023-01-28 11:42:29,930 - INFO - evaluating now!
2023-01-28 11:42:31,158 - INFO - Epoch [33/100] train_loss: 4.6969, val_loss: 5.2125, lr: 0.003000, 19.08s
2023-01-28 11:42:48,853 - INFO - epoch complete!
2023-01-28 11:42:48,853 - INFO - 17.693790912628174
2023-01-28 11:42:48,854 - INFO - evaluating now!
2023-01-28 11:42:50,097 - INFO - Epoch [34/100] train_loss: 4.7001, val_loss: 5.2172, lr: 0.003000, 18.94s
2023-01-28 11:43:08,039 - INFO - epoch complete!
2023-01-28 11:43:08,040 - INFO - 17.94091272354126
2023-01-28 11:43:08,041 - INFO - evaluating now!
2023-01-28 11:43:09,271 - INFO - Epoch [35/100] train_loss: 4.6598, val_loss: 5.2153, lr: 0.003000, 19.17s
2023-01-28 11:43:26,883 - INFO - epoch complete!
2023-01-28 11:43:26,884 - INFO - 17.611189603805542
2023-01-28 11:43:26,884 - INFO - evaluating now!
2023-01-28 11:43:28,113 - INFO - Epoch [36/100] train_loss: 4.6549, val_loss: 5.1947, lr: 0.003000, 18.84s
2023-01-28 11:43:45,919 - INFO - epoch complete!
2023-01-28 11:43:45,921 - INFO - 17.803945541381836
2023-01-28 11:43:45,921 - INFO - evaluating now!
2023-01-28 11:43:47,146 - INFO - Epoch [37/100] train_loss: 4.6220, val_loss: 5.2485, lr: 0.003000, 19.03s
2023-01-28 11:44:04,890 - INFO - epoch complete!
2023-01-28 11:44:04,891 - INFO - 17.74257230758667
2023-01-28 11:44:04,891 - INFO - evaluating now!
2023-01-28 11:44:06,098 - INFO - Epoch [38/100] train_loss: 4.6075, val_loss: 5.2795, lr: 0.003000, 18.95s
2023-01-28 11:44:24,109 - INFO - epoch complete!
2023-01-28 11:44:24,110 - INFO - 18.009830236434937
2023-01-28 11:44:24,110 - INFO - evaluating now!
2023-01-28 11:44:25,380 - INFO - Epoch [39/100] train_loss: 4.6525, val_loss: 5.2071, lr: 0.003000, 19.28s
2023-01-28 11:44:43,602 - INFO - epoch complete!
2023-01-28 11:44:43,602 - INFO - 18.221124172210693
2023-01-28 11:44:43,602 - INFO - evaluating now!
2023-01-28 11:44:44,855 - INFO - Epoch [40/100] train_loss: 4.6054, val_loss: 5.2635, lr: 0.003000, 19.48s
2023-01-28 11:45:02,759 - INFO - epoch complete!
2023-01-28 11:45:02,760 - INFO - 17.903085947036743
2023-01-28 11:45:02,760 - INFO - evaluating now!
2023-01-28 11:45:04,024 - INFO - Epoch [41/100] train_loss: 4.5617, val_loss: 5.2628, lr: 0.003000, 19.17s
2023-01-28 11:45:22,553 - INFO - epoch complete!
2023-01-28 11:45:22,553 - INFO - 18.526914358139038
2023-01-28 11:45:22,553 - INFO - evaluating now!
2023-01-28 11:45:23,808 - INFO - Epoch [42/100] train_loss: 4.5331, val_loss: 5.3088, lr: 0.003000, 19.78s
2023-01-28 11:45:41,891 - INFO - epoch complete!
2023-01-28 11:45:41,892 - INFO - 18.080644130706787
2023-01-28 11:45:41,892 - INFO - evaluating now!
2023-01-28 11:45:43,104 - INFO - Epoch [43/100] train_loss: 4.5381, val_loss: 5.2055, lr: 0.003000, 19.30s
2023-01-28 11:46:00,848 - INFO - epoch complete!
2023-01-28 11:46:00,848 - INFO - 17.74245262145996
2023-01-28 11:46:00,848 - INFO - evaluating now!
2023-01-28 11:46:02,074 - INFO - Epoch [44/100] train_loss: 4.5234, val_loss: 5.2771, lr: 0.003000, 18.97s
2023-01-28 11:46:20,010 - INFO - epoch complete!
2023-01-28 11:46:20,011 - INFO - 17.93417239189148
2023-01-28 11:46:20,011 - INFO - evaluating now!
2023-01-28 11:46:21,284 - INFO - Epoch [45/100] train_loss: 4.4739, val_loss: 5.2908, lr: 0.003000, 19.21s
2023-01-28 11:46:39,393 - INFO - epoch complete!
2023-01-28 11:46:39,394 - INFO - 18.107309341430664
2023-01-28 11:46:39,394 - INFO - evaluating now!
2023-01-28 11:46:40,644 - INFO - Epoch [46/100] train_loss: 4.4931, val_loss: 5.3097, lr: 0.003000, 19.36s
2023-01-28 11:46:58,331 - INFO - epoch complete!
2023-01-28 11:46:58,332 - INFO - 17.686033248901367
2023-01-28 11:46:58,333 - INFO - evaluating now!
2023-01-28 11:46:59,569 - INFO - Epoch [47/100] train_loss: 4.4394, val_loss: 5.2434, lr: 0.003000, 18.92s
2023-01-28 11:47:17,040 - INFO - epoch complete!
2023-01-28 11:47:17,042 - INFO - 17.469525814056396
2023-01-28 11:47:17,042 - INFO - evaluating now!
2023-01-28 11:47:18,274 - INFO - Epoch [48/100] train_loss: 4.4188, val_loss: 5.2436, lr: 0.003000, 18.70s
2023-01-28 11:47:36,486 - INFO - epoch complete!
2023-01-28 11:47:36,487 - INFO - 18.21163821220398
2023-01-28 11:47:36,487 - INFO - evaluating now!
2023-01-28 11:47:37,723 - INFO - Epoch [49/100] train_loss: 4.3960, val_loss: 5.2547, lr: 0.003000, 19.45s
2023-01-28 11:47:55,666 - INFO - epoch complete!
2023-01-28 11:47:55,668 - INFO - 17.94248914718628
2023-01-28 11:47:55,668 - INFO - evaluating now!
2023-01-28 11:47:56,897 - INFO - Epoch [50/100] train_loss: 4.3736, val_loss: 5.2592, lr: 0.003000, 19.17s
2023-01-28 11:48:14,892 - INFO - epoch complete!
2023-01-28 11:48:14,894 - INFO - 17.994179248809814
2023-01-28 11:48:14,894 - INFO - evaluating now!
2023-01-28 11:48:16,119 - INFO - Epoch [51/100] train_loss: 4.4050, val_loss: 5.3005, lr: 0.003000, 19.22s
2023-01-28 11:48:33,701 - INFO - epoch complete!
2023-01-28 11:48:33,702 - INFO - 17.580098628997803
2023-01-28 11:48:33,702 - INFO - evaluating now!
2023-01-28 11:48:34,931 - INFO - Epoch [52/100] train_loss: 4.3545, val_loss: 5.3570, lr: 0.003000, 18.81s
2023-01-28 11:48:53,066 - INFO - epoch complete!
2023-01-28 11:48:53,067 - INFO - 18.133667945861816
2023-01-28 11:48:53,067 - INFO - evaluating now!
2023-01-28 11:48:54,354 - INFO - Epoch [53/100] train_loss: 4.3234, val_loss: 5.2818, lr: 0.003000, 19.42s
2023-01-28 11:49:12,647 - INFO - epoch complete!
2023-01-28 11:49:12,648 - INFO - 18.292181968688965
2023-01-28 11:49:12,648 - INFO - evaluating now!
2023-01-28 11:49:13,919 - INFO - Epoch [54/100] train_loss: 4.3024, val_loss: 5.3092, lr: 0.003000, 19.57s
2023-01-28 11:49:32,650 - INFO - epoch complete!
2023-01-28 11:49:32,650 - INFO - 18.728816270828247
2023-01-28 11:49:32,651 - INFO - evaluating now!
2023-01-28 11:49:33,928 - INFO - Epoch [55/100] train_loss: 4.2568, val_loss: 5.3191, lr: 0.003000, 20.01s
2023-01-28 11:49:52,616 - INFO - epoch complete!
2023-01-28 11:49:52,617 - INFO - 18.686578035354614
2023-01-28 11:49:52,617 - INFO - evaluating now!
2023-01-28 11:49:53,893 - INFO - Epoch [56/100] train_loss: 4.2500, val_loss: 5.3108, lr: 0.003000, 19.96s
2023-01-28 11:50:12,283 - INFO - epoch complete!
2023-01-28 11:50:12,283 - INFO - 18.38848876953125
2023-01-28 11:50:12,284 - INFO - evaluating now!
2023-01-28 11:50:13,576 - INFO - Epoch [57/100] train_loss: 4.2263, val_loss: 5.2869, lr: 0.003000, 19.68s
2023-01-28 11:50:31,710 - INFO - epoch complete!
2023-01-28 11:50:31,711 - INFO - 18.132848024368286
2023-01-28 11:50:31,711 - INFO - evaluating now!
2023-01-28 11:50:32,971 - INFO - Epoch [58/100] train_loss: 4.2043, val_loss: 5.3457, lr: 0.003000, 19.39s
2023-01-28 11:50:50,812 - INFO - epoch complete!
2023-01-28 11:50:50,814 - INFO - 17.84043526649475
2023-01-28 11:50:50,814 - INFO - evaluating now!
2023-01-28 11:50:52,069 - INFO - Epoch [59/100] train_loss: 4.1823, val_loss: 5.3156, lr: 0.003000, 19.10s
2023-01-28 11:51:10,400 - INFO - epoch complete!
2023-01-28 11:51:10,401 - INFO - 18.330364227294922
2023-01-28 11:51:10,401 - INFO - evaluating now!
2023-01-28 11:51:11,653 - INFO - Epoch [60/100] train_loss: 4.1683, val_loss: 5.3891, lr: 0.003000, 19.58s
2023-01-28 11:51:29,620 - INFO - epoch complete!
2023-01-28 11:51:29,621 - INFO - 17.96578359603882
2023-01-28 11:51:29,621 - INFO - evaluating now!
2023-01-28 11:51:30,859 - INFO - Epoch [61/100] train_loss: 4.1628, val_loss: 5.3324, lr: 0.003000, 19.21s
2023-01-28 11:51:48,573 - INFO - epoch complete!
2023-01-28 11:51:48,574 - INFO - 17.712992906570435
2023-01-28 11:51:48,575 - INFO - evaluating now!
2023-01-28 11:51:49,795 - INFO - Epoch [62/100] train_loss: 4.1034, val_loss: 5.3474, lr: 0.003000, 18.94s
2023-01-28 11:52:07,287 - INFO - epoch complete!
2023-01-28 11:52:07,289 - INFO - 17.49091100692749
2023-01-28 11:52:07,289 - INFO - evaluating now!
2023-01-28 11:52:08,520 - INFO - Epoch [63/100] train_loss: 4.0940, val_loss: 5.3645, lr: 0.003000, 18.72s
2023-01-28 11:52:26,379 - INFO - epoch complete!
2023-01-28 11:52:26,379 - INFO - 17.857610940933228
2023-01-28 11:52:26,380 - INFO - evaluating now!
2023-01-28 11:52:27,599 - INFO - Epoch [64/100] train_loss: 4.0643, val_loss: 5.3770, lr: 0.003000, 19.08s
2023-01-28 11:52:45,116 - INFO - epoch complete!
2023-01-28 11:52:45,117 - INFO - 17.516032695770264
2023-01-28 11:52:45,117 - INFO - evaluating now!
2023-01-28 11:52:46,352 - INFO - Epoch [65/100] train_loss: 4.0354, val_loss: 5.4764, lr: 0.003000, 18.75s
2023-01-28 11:53:03,675 - INFO - epoch complete!
2023-01-28 11:53:03,676 - INFO - 17.322088479995728
2023-01-28 11:53:03,676 - INFO - evaluating now!
2023-01-28 11:53:04,899 - INFO - Epoch [66/100] train_loss: 4.0280, val_loss: 5.3656, lr: 0.003000, 18.55s
2023-01-28 11:53:22,481 - INFO - epoch complete!
2023-01-28 11:53:22,481 - INFO - 17.579510927200317
2023-01-28 11:53:22,481 - INFO - evaluating now!
2023-01-28 11:53:23,694 - INFO - Epoch [67/100] train_loss: 3.9988, val_loss: 5.3638, lr: 0.003000, 18.79s
2023-01-28 11:53:41,966 - INFO - epoch complete!
2023-01-28 11:53:41,968 - INFO - 18.26949691772461
2023-01-28 11:53:41,968 - INFO - evaluating now!
2023-01-28 11:53:43,260 - INFO - Epoch [68/100] train_loss: 3.9845, val_loss: 5.4062, lr: 0.003000, 19.56s
2023-01-28 11:54:01,206 - INFO - epoch complete!
2023-01-28 11:54:01,208 - INFO - 17.94527244567871
2023-01-28 11:54:01,208 - INFO - evaluating now!
2023-01-28 11:54:02,482 - INFO - Epoch [69/100] train_loss: 3.9524, val_loss: 5.4340, lr: 0.003000, 19.22s
2023-01-28 11:54:20,429 - INFO - epoch complete!
2023-01-28 11:54:20,431 - INFO - 17.945786476135254
2023-01-28 11:54:20,431 - INFO - evaluating now!
2023-01-28 11:54:21,667 - INFO - Epoch [70/100] train_loss: 3.9171, val_loss: 5.3873, lr: 0.003000, 19.18s
2023-01-28 11:54:39,653 - INFO - epoch complete!
2023-01-28 11:54:39,653 - INFO - 17.984291791915894
2023-01-28 11:54:39,654 - INFO - evaluating now!
2023-01-28 11:54:40,892 - INFO - Epoch [71/100] train_loss: 3.9093, val_loss: 5.4398, lr: 0.003000, 19.22s
2023-01-28 11:54:58,797 - INFO - epoch complete!
2023-01-28 11:54:58,798 - INFO - 17.903570652008057
2023-01-28 11:54:58,798 - INFO - evaluating now!
2023-01-28 11:55:00,036 - INFO - Epoch [72/100] train_loss: 3.8755, val_loss: 5.4856, lr: 0.003000, 19.14s
2023-01-28 11:55:17,566 - INFO - epoch complete!
2023-01-28 11:55:17,566 - INFO - 17.528602600097656
2023-01-28 11:55:17,566 - INFO - evaluating now!
2023-01-28 11:55:18,818 - INFO - Epoch [73/100] train_loss: 3.8425, val_loss: 5.4512, lr: 0.003000, 18.78s
2023-01-28 11:55:36,476 - INFO - epoch complete!
2023-01-28 11:55:36,476 - INFO - 17.65645408630371
2023-01-28 11:55:36,476 - INFO - evaluating now!
2023-01-28 11:55:37,703 - INFO - Epoch [74/100] train_loss: 3.8199, val_loss: 5.4808, lr: 0.003000, 18.88s
2023-01-28 11:55:55,309 - INFO - epoch complete!
2023-01-28 11:55:55,310 - INFO - 17.605359315872192
2023-01-28 11:55:55,311 - INFO - evaluating now!
2023-01-28 11:55:56,530 - INFO - Epoch [75/100] train_loss: 3.7837, val_loss: 5.4453, lr: 0.003000, 18.83s
2023-01-28 11:56:14,021 - INFO - epoch complete!
2023-01-28 11:56:14,022 - INFO - 17.489075183868408
2023-01-28 11:56:14,022 - INFO - evaluating now!
2023-01-28 11:56:15,246 - INFO - Epoch [76/100] train_loss: 3.7658, val_loss: 5.4637, lr: 0.003000, 18.71s
2023-01-28 11:56:32,898 - INFO - epoch complete!
2023-01-28 11:56:32,899 - INFO - 17.650471448898315
2023-01-28 11:56:32,899 - INFO - evaluating now!
2023-01-28 11:56:34,120 - INFO - Epoch [77/100] train_loss: 3.7581, val_loss: 5.5030, lr: 0.003000, 18.87s
2023-01-28 11:56:51,987 - INFO - epoch complete!
2023-01-28 11:56:51,989 - INFO - 17.866258144378662
2023-01-28 11:56:51,989 - INFO - evaluating now!
2023-01-28 11:56:53,208 - INFO - Epoch [78/100] train_loss: 3.7282, val_loss: 5.5038, lr: 0.003000, 19.09s
2023-01-28 11:56:53,209 - WARNING - Early stopping at epoch: 78
2023-01-28 11:56:53,209 - INFO - Trained totally 79 epochs, average train time is 18.040s, average eval time is 1.251s
2023-01-28 11:56:53,258 - INFO - Loaded model at 28
2023-01-28 11:56:53,258 - INFO - Saved model at ./libcity/cache/30859/model_cache/AGCRN_NYCBike.m
2023-01-28 11:56:53,274 - INFO - Start evaluating ...
2023-01-28 11:56:56,357 - INFO - Note that you select the single mode to evaluate!
2023-01-28 11:56:56,362 - INFO - Evaluate result is saved at ./libcity/cache/30859/evaluate_cache/2023_01_28_11_56_56_AGCRN_NYCBike.csv
2023-01-28 11:56:56,374 - INFO - 
        MAE  MAPE         MSE       RMSE  masked_MAE  masked_MAPE  masked_MSE  masked_RMSE        R2      EVAR
1  5.215244   inf  362.740021  19.045734    5.215244     1.096218   44.303493     6.656087  0.063288  0.302803
